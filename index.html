<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test InputMap</title>
    <style>
        body{
            width: 100%;
            height: 100%;
            font-family: Verdana;
        }
        #wrapper{
            margin: 100px auto;
            display: block;
            width: 604px;
            text-align: center;
        }
        iframe{
            border:2px solid #333;
            display: block;
        }
    </style>
</head>
<body>
<div id="wrapper">
    <h1>Test InputMap</h1>
    <p>
        InputMap in embed in an iframe tag
    </p>
    <!--<iframe title="input a location" width="600" height="600" src="src/index.html?domain=https://inputmap.fldev.di.unito.it&lat=45.070312&lon=7.686856&zoom=12&contrast=false"></iframe>-->
    <!--<iframe title="input a location" width="600" height="600" src="src/index.html?domain=https://inputmap.firslife.org&lat=45.070312&lon=7.686856&zoom=12&contrast=false"></iframe>-->
    <iframe title="input a location" width="600" height="600" src="src/index.html?domain=http://localhost:8080&lat=45.070312&lon=7.686856&zoom=12&contrast=false"></iframe>
    <p></p>
    <p>
    <h4>Returned object to the hosting window:</h4>
    <div id="helper">

    </div>
    <div>
        Latitude: <span id="lat"></span>
    </div>
    <div>
        Longitude:<span id="lon"></span>
    </div>
    <div>
        Zoom: <span id="zoom"></span>
    </div>
    <div>
        Id: <span id="id"></span>
    </div>
    <div>
        Name: <span id="name"></span>
    </div>
    </p>
</div>
</body>
<script>
//    var iframeDomain = "https://inputmap.fldev.di.unito.it";
//    var iframeDomain = "http://inputmap.firstlife.org";
    var iframeDomain = "http://localhost:8080";

    window.addEventListener( "message",
        function (e) {
            if (e.defaultPrevented)
                return
            e.preventDefault();

            if (e.origin !== iframeDomain) {
                return;
            }
//            console.debug('window event event!', e);
            if(e.data.src == 'InputMap')
                helper(e.data);
        });
    function helper(data){
        console.log('got message',data);
        document.getElementById("lat").innerHTML = data.lat;
        document.getElementById("lon").innerHTML = data.lng;
        document.getElementById("zoom").innerHTML = data.zoom_level;
        document.getElementById("id").innerHTML = data.id;
        document.getElementById("name").innerHTML = data.name;
    }
</script>
</html>